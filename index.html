<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DeepRacer Reward Function Visualizer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .slider-thumb::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 16px; height: 16px;
            background: #4f46e5;
            cursor: pointer;
            border-radius: 50%;
        }
        .slider-thumb::-moz-range-thumb {
            width: 16px; height: 16px;
            background: #4f46e5;
            cursor: pointer;
            border-radius: 50%;
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">

<div class="container mx-auto p-4 md:p-8">
    <header class="text-center mb-8">
        <h1 class="text-3xl md:text-4xl font-bold">DeepRacer Reward Function Visualizer</h1>
        <p class="text-gray-600 mt-2">Testen Sie Ihre Reward-Funktion interaktiv.</p>
    </header>

    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
        <!-- Steuerung -->
        <div class="lg:col-span-1 bg-white p-6 rounded-2xl shadow-lg space-y-6">

            <!-- Car Parameters -->
            <div>
                <h2 class="text-xl font-semibold mb-3 border-b pb-2">Car Parameters</h2>
                <div class="space-y-4">
                    <div>
                        <label>Car X Position: <span id="car-x-value">150</span></label>
                        <input type="range" id="car-x" min="0" max="1000" value="150" class="w-full slider-thumb">
                    </div>
                    <div>
                        <label>Car Y Position: <span id="car-y-value">150</span></label>
                        <input type="range" id="car-y" min="0" max="1000" value="150" class="w-full slider-thumb">
                    </div>
                    <div>
                        <label>Heading: <span id="heading-value">45°</span></label>
                        <input type="range" id="heading" min="-180" max="180" value="45" class="w-full slider-thumb">
                    </div>
                    <div>
                        <label>Speed: <span id="speed-value">5.0</span></label>
                        <input type="range" id="speed" min="0" max="10" step="0.1" value="5" class="w-full slider-thumb">
                    </div>
                    <div>
                        <label>Waypoints: <span id="closest_waypoints"></span></label>
                    </div>
                    <div>
                        <label class="inline-flex items-center mt-3">
                            <input type="checkbox" id="look-at-mouse" class="form-checkbox h-5 w-5 text-indigo-600">
                            <span class="ml-2">Auto schaut immer zur Maus</span>
                        </label>
                    </div>
                </div>
            </div>

            <!-- Model Auswahl -->
            <div>
                <label for="model-select" class="block text-sm font-medium text-gray-700">Reward Function wählen:</label>
                <select id="model-select" class="mt-1 block w-full p-2 border rounded-md focus:ring-2 focus:ring-indigo-500"></select>
            </div>

            <!-- Reward -->
            <div class="bg-indigo-50 p-6 rounded-xl text-center">
                <h2 class="text-lg font-semibold text-indigo-800">Calculated Reward</h2>
                <p id="reward-value" class="text-4xl font-bold text-indigo-600 mt-2">0.0000</p>
            </div>
        </div>

        <!-- Canvas -->
        <div class="lg:col-span-2 bg-white p-4 rounded-2xl shadow-lg flex items-center justify-center">
            <canvas id="track-canvas" class="w-full h-full rounded-lg"></canvas>
        </div>
    </div>
</div>

<script>
const canvas = document.getElementById('track-canvas');
const ctx = canvas.getContext('2d');

const carXSlider = document.getElementById('car-x');
const carYSlider = document.getElementById('car-y');
const headingSlider = document.getElementById('heading');
const speedSlider = document.getElementById('speed');
const carXValue = document.getElementById('car-x-value');
const carYValue = document.getElementById('car-y-value');
const closestWaypoints = document.getElementById('closest_waypoints')
const headingValue = document.getElementById('heading-value');
const speedValue = document.getElementById('speed-value');
const rewardValue = document.getElementById('reward-value');
const lookAtMouseCheckbox = document.getElementById('look-at-mouse');
const modelSelect = document.getElementById('model-select');

let state = {
    car: { x: 3.408314959676616, y: 1.4717702850315393, heading: 45, speed: 5 },
    waypoints: [
        [3.408314959676616, 1.4717702850315393],
        [3.278316020965576, 1.471244990825653],
        [3.148323229010334, 1.4698760351357125],
        [2.974927544593811, 1.4680500030517578],
        [2.671554446220398, 1.4732159972190857],
        [2.3681689500808716, 1.4696124792099],
        [2.0653909444808973, 1.4793429970741272],
        [1.7702519893646231, 1.5481655001640322],
        [1.483372986316681, 1.6465474963188171],
        [1.1825209856033325, 1.665496051311493],
        [0.8996591567993164, 1.55953049659729],
        [0.6058058738708496, 1.493058979511261],
        [0.3036217987537384, 1.4668729901313782],
        [0.00022387993521988392, 1.4644305109977722],
        [-0.3031398057937622, 1.4698509573936462],
        [-0.6065511703491211, 1.4700390100479126],
        [-0.9099699556827545, 1.4700774550437927],
        [-1.2133870124816895, 1.4710184931755066],
        [-1.516803503036499, 1.472249984741211],
        [-1.8202179670333862, 1.4738149642944336],
        [-2.1236274242401123, 1.4759759902954102],
        [-2.427031993865967, 1.4785684943199158],
        [-2.7303649187088013, 1.472720980644226],
        [-3.0334941148757935, 1.4606574773788452],
        [-3.336466908454895, 1.4711779952049255],
        [-3.6301519870758057, 1.54459547996521],
        [-3.9102929830551147, 1.65993994474411],
        [-4.20968532562256, 1.703934550285339],
        [-4.496387481689454, 1.6192825436592089],
        [-4.708314418792725, 1.4057174921035767],
        [-4.802008390426635, 1.1188610196113604],
        [-4.860429525375366, 0.8211241662502311],
        [-4.920632362365723, 0.5237410515546799],
        [-4.97938084602356, 0.22606505453586578],
        [-5.031064033508301, -0.07268327847123146],
        [-4.979203701019287, -0.36956214904785156],
        [-4.809752941131592, -0.617946207523346],
        [-4.550312995910643, -0.7715703397989278],
        [-4.257645130157471, -0.8490209430456161],
        [-3.9584025144577026, -0.8976912498474121],
        [-3.6566635370254517, -0.9255106151103973],
        [-3.3626874685287476, -0.9994447827339172],
        [-3.0748790502548218, -1.0955036282539368],
        [-2.786156415939331, -1.1866423189640045],
        [-2.486029028892517, -1.2304852604866028],
        [-2.1842055320739746, -1.2615086436271667],
        [-1.8819324970245361, -1.2877083718776703],
        [-1.5803679823875427, -1.260584980249405],
        [-1.2913404703140259, -1.1709365844726562],
        [-0.9996453821659088, -1.0925500392913818],
        [-0.6984832286834717, -1.116917371749878],
        [-0.420046791434288, -1.2342189252376556],
        [-0.14777036756277084, -1.3665609955787659],
        [0.14819640666246414, -1.4308984875679016],
        [0.4421359449625015, -1.3735359907150269],
        [0.6987309455871582, -1.212949424982071],
        [0.9145341217517853, -1.0006998777389526],
        [1.1385363936424255, -0.7995848059654236],
        [1.4211704730987549, -0.6919995695352554],
        [1.7221534848213196, -0.6560808718204498],
        [2.024604022502899, -0.6640181243419647],
        [2.3245800733566284, -0.7095721513032913],
        [2.6152199506759644, -0.7918080240488052],
        [2.857451558113098, -0.9721536040306091],
        [2.9898489713668823, -1.240626037120819],
        [3.1674790382385254, -1.4824514985084534],
        [3.4428740739822388, -1.601032018661499],
        [3.7423360347747803, -1.6497185230255127],
        [4.044067859649658, -1.681160032749176],
        [4.347193956375122, -1.6917835474014282],
        [4.643414497375488, -1.6374415159225464],
        [4.8928515911102295, -1.4685439467430115],
        [5.023529529571533, -1.1997559666633606],
        [5.024764060974121, -0.8974809050559998],
        [4.991261959075928, -0.5959695875644686],
        [4.958872318267822, -0.29428809881210327],
        [4.9252283573150635, 0.007256770506501198],
        [4.894884347915649, 0.3091498017311096],
        [4.8511130809783936, 0.6092253923416138],
        [4.804372549057007, 0.9090217053890233],
        [4.708405017852783, 1.1938440203666687],
        [4.480142593383789, 1.3866339921951294],
        [4.187997817993164, 1.4637395143508911],
        [3.8851370811462402, 1.47393000125885],
        [3.5817264318466187, 1.472470998764038],
        [3.408314959676616, 1.4717702850315393]
    ],
    perfect_line_old: [
        [ 3.02139987e+00,  1.45869374e+00],
       [ 2.79611184e+00,  1.47645259e+00],
       [ 2.55766258e+00,  1.48780603e+00],
       [ 2.29900224e+00,  1.49458953e+00],
       [ 2.02424354e+00,  1.49874595e+00],
       [ 1.74275391e+00,  1.50110821e+00],
       [ 1.45725946e+00,  1.50199393e+00],
       [ 1.16886336e+00,  1.50162237e+00],
       [ 8.78304133e-01,  1.50021371e+00],
       [ 5.86069246e-01,  1.49794748e+00],
       [ 2.92466572e-01,  1.49494849e+00],
       [-2.22807462e-03,  1.49134398e+00],
       [-3.05033588e-01,  1.48822038e+00],
       [-6.07850904e-01,  1.48569301e+00],
       [-9.10677172e-01,  1.48382932e+00],
       [-1.21350835e+00,  1.48270283e+00],
       [-1.51633800e+00,  1.48247677e+00],
       [-1.81915338e+00,  1.48333176e+00],
       [-2.12192930e+00,  1.48550648e+00],
       [-2.42461912e+00,  1.48924952e+00],
       [-2.72713106e+00,  1.49487593e+00],
       [-3.02929272e+00,  1.50276164e+00],
       [-3.31666816e+00,  1.50306270e+00],
       [-3.58971910e+00,  1.48796349e+00],
       [-3.84740433e+00,  1.45128247e+00],
       [-4.08736552e+00,  1.38697438e+00],
       [-4.30556573e+00,  1.28907047e+00],
       [-4.48263832e+00,  1.13830908e+00],
       [-4.61868080e+00,  9.50257845e-01],
       [-4.71254361e+00,  7.36444170e-01],
       [-4.76149703e+00,  5.06685023e-01],
       [-4.76477995e+00,  2.71077025e-01],
       [-4.72186912e+00,  3.90669011e-02],
       [-4.63340804e+00, -1.80418361e-01],
       [-4.49616860e+00, -3.76413035e-01],
       [-4.32149836e+00, -5.47801105e-01],
       [-4.11656266e+00, -6.95863150e-01],
       [-3.88551122e+00, -8.21532712e-01],
       [-3.63215805e+00, -9.26308373e-01],
       [-3.35909999e+00, -1.01054260e+00],
       [-3.07092028e+00, -1.07503883e+00],
       [-2.77581412e+00, -1.12150552e+00],
       [-2.47917460e+00, -1.15293730e+00],
       [-2.18295538e+00, -1.17225174e+00],
       [-1.88891336e+00, -1.18187827e+00],
       [-1.59804671e+00, -1.18380784e+00],
       [-1.31031011e+00, -1.17956771e+00],
       [-1.02527294e+00, -1.17035524e+00],
       [-7.42518477e-01, -1.15701164e+00],
       [-4.61653778e-01, -1.14024579e+00],
       [-1.82360881e-01, -1.12061176e+00],
       [ 9.56350748e-02, -1.09858535e+00],
       [ 3.72592885e-01, -1.07461769e+00],
       [ 6.41497759e-01, -1.05354467e+00],
       [ 9.09609952e-01, -1.03626712e+00],
       [ 1.17663085e+00, -1.02445902e+00],
       [ 1.44221791e+00, -1.02018420e+00],
       [ 1.70606482e+00, -1.02546064e+00],
       [ 1.96778854e+00, -1.04275241e+00],
       [ 2.22680099e+00, -1.07544580e+00],
       [ 2.48377653e+00, -1.11947762e+00],
       [ 2.73879640e+00, -1.17411218e+00],
       [ 2.99174125e+00, -1.23921014e+00],
       [ 3.24113400e+00, -1.31425136e+00],
       [ 3.48919940e+00, -1.37563561e+00],
       [ 3.73499993e+00, -1.41671665e+00],
       [ 3.97597469e+00, -1.42837730e+00],
       [ 4.20765790e+00, -1.40213719e+00],
       [ 4.42281524e+00, -1.33034535e+00],
       [ 4.61056875e+00, -1.20656648e+00],
       [ 4.74879565e+00, -1.02121557e+00],
       [ 4.84434714e+00, -7.98979581e-01],
       [ 4.89637089e+00, -5.48596060e-01],
       [ 4.90323568e+00, -2.80997099e-01],
       [ 4.86793001e+00, -1.17814914e-02],
       [ 4.79713758e+00,  2.46607366e-01],
       [ 4.69598542e+00,  4.86912653e-01],
       [ 4.56896570e+00,  7.05073712e-01],
       [ 4.41912338e+00,  8.97792409e-01],
       [ 4.24898530e+00,  1.06151291e+00],
       [ 4.05933211e+00,  1.18474399e+00],
       [ 3.86040708e+00,  1.27633820e+00],
       [ 3.65667633e+00,  1.34473660e+00],
       [ 3.44942397e+00,  1.39560199e+00],
       [ 3.23819139e+00,  1.43252829e+00],
       [ 3.02139987e+00,  1.45869374e+00]
    ],
    perfect_line: [[3.3966135878355668, 1.4048339560864744], [3.2705586838304703, 1.4268700510949406], [3.1451706167544136, 1.4437553453355534], [2.974481553982661, 1.4623921847704768], [2.6719899439851504, 1.4823624867180307], [2.3687759972195184, 1.492759677452452], [2.065674981941035, 1.4981191946910233], [1.7698551761254664, 1.5008807762685423], [1.4829242752885623, 1.5019143072956098], [1.1827320920156181, 1.501640238015787], [0.8999462217968416, 1.5003186329966616], [0.6057667798555759, 1.4981002309005096], [0.30333388910664355, 1.495059493673385], [-0.00010562534685010228, 1.4913699403956748], [-0.30332947749746564, 1.4882379588066283], [-0.6066819029940562, 1.4857027667012066], [-0.9100546126511451, 1.4838331514299499], [-1.2134304776723992, 1.482703119674263], [-1.5167746245391232, 1.4824780027960844], [-1.8201495602510778, 1.483338915169789], [-2.123509329295038, 1.4855260185257835], [-2.426832572126357, 1.4892906879260601], [-2.7297849190293486, 1.4949451894907189], [-3.0334500011881746, 1.5027659952471795], [-3.338164340588126, 1.5018740011260903], [-3.6214476122848094, 1.4834469944535176], [-3.8539070616212063, 1.4495397788158864], [-4.08736552, 1.38697438], [-4.30556573, 1.28907047], [-4.481479920826172, 1.1392953527462293], [-4.601595077325136, 0.9738754036469437], [-4.705271051897833, 0.7530106074897277], [-4.76149703, 0.506685023], [-4.7638283659561464, 0.26593200375674503], [-4.72186912, 0.039066901099999995], [-4.63340804, -0.180418361], [-4.4961686, -0.376413035], [-4.326211171789533, -0.5431768500789482], [-4.136555689847952, -0.6814185759944277], [-3.9097956013697694, -0.8083243651046945], [-3.653366250604141, -0.9175375996289012], [-3.365501764346146, -1.0085677507189494], [-3.07092028, -1.07503883], [-2.7758980548235677, -1.1214923038291584], [-2.4791746, -1.1529373], [-2.181285174365847, -1.1723064202278237], [-1.8812307725447066, -1.1819292352456756], [-1.5815029744641789, -1.1835640490142252], [-1.2910815963241273, -1.178946239805837], [-0.9960387456106391, -1.168975635264092], [-0.6962547072825865, -1.1542499849173984], [-0.426825136847027, -1.137797369031898], [-0.16735184915399923, -1.1194225517318737], [0.11926141264756135, -1.0965407496611739], [0.4184293973461625, -1.0710256623545622], [0.6882644568423436, -1.050530954169829], [0.9160942828141603, -1.035980372306242], [1.148535640141928, -1.025701436043126], [1.42645693049641, -1.0204378846125017], [1.70606482, -1.02546064], [1.9766576494400883, -1.0438718977075503], [2.260888175138789, -1.081286514646763], [2.5423335610133244, -1.1320226723691325], [2.801333348217993, -1.190206707141458], [2.990308278924103, -1.2388413501480622], [3.2200029174018656, -1.3078931069309563], [3.4891994, -1.37563561], [3.753567404133212, -1.4176151209321899], [4.0149382426388796, -1.4239643435875133], [4.246250497949515, -1.3892599457601524], [4.435461198470236, -1.322008342348251], [4.61056875, -1.20656648], [4.74879565, -1.02121557], [4.836752136696826, -0.8166442251676547], [4.890862153090682, -0.5751088919972673], [4.902931536414644, -0.29285303449637196], [4.867078854657986, -0.008674816628517297], [4.789486288054825, 0.2647843965923884], [4.682074048889052, 0.5108059465272291], [4.558830873551872, 0.7181085512056679], [4.41912338, 0.897792409], [4.2489853, 1.06151291], [4.05933211, 1.18474399], [3.823014394141654, 1.2888920235362777], [3.5564160556256272, 1.3693432098236926], [3.3966135878355668, 1.4048339560864744]],
    closestWaypoints: [0, 1],
    is_offtrack: false
};

let draggingCar = false;
let lookAtMouse = false;
let mousePos = { x: 0, y: 0 };
let currentModel = "";

// --- Hilfsfunktionen ---
function dist2d(a, b) {
    return Math.hypot(a[0] - b[0], a[1] - b[1]);
}

let scale = 100; // zoom factor

function worldToScreen(p) {
    return [
        p[0] * scale + canvas.width / 2,
        p[1] * -scale + canvas.height / 2
    ];
}

function screenToWorld(p) {
    return [
        (p.x - canvas.width / 2) / scale,
        (p.y - canvas.height / 2) / -scale
    ];
}

function updateClosestWaypoints() {
    const distances = state.waypoints.map((wp, idx) => ({
        idx,
        dist: dist2d([state.car.x, state.car.y], wp)
    }));
    distances.sort((a, b) => a.dist - b.dist);
    const first = distances[0].idx;
    const second = distances[1].idx;
    state.closestWaypoints = first < second ? [first, second] : [second, first];
}


// --- Model Auswahl laden ---
function loadModels() {
    fetch('/models')
        .then(res => res.json())
        .then(models => {
            modelSelect.innerHTML = "";
            models.forEach(m => {
                const opt = document.createElement('option');
                opt.value = m;
                opt.textContent = m;
                modelSelect.appendChild(opt);
            });
            currentModel = models[0] || "";
            fetchReward();
        });
}

modelSelect.addEventListener('change', e => {
    currentModel = e.target.value;
    fetchReward();
});

// --- Reward vom Server holen ---
function fetchReward() {
    updateClosestWaypoints();
    fetch('/reward', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
            model: currentModel,
            params: {
                x: state.car.x,
                y: state.car.y,
                heading: state.car.heading,
                speed: state.car.speed,
                waypoints: state.waypoints,
                closest_waypoints: state.closestWaypoints,
                is_offtrack: state.is_offtrack,
                track_width: 0.76
            }
        })
    })
    .then(res => res.json())
    .then(data => {
        if (data.reward !== undefined) {
            rewardValue.textContent = data.reward.toFixed(4);
        } else {
            rewardValue.textContent = "ERR";
            console.error(data.error);
        }
    });
}

// --- Zeichnen ---
function draw() {
    const rect = canvas.parentElement.getBoundingClientRect();
    canvas.width = rect.width;
    canvas.height = rect.height;
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // Track
    ctx.beginPath();
    const [startX, startY] = worldToScreen(state.waypoints[0]);
    ctx.moveTo(startX, startY);
    state.waypoints.forEach(wp => {
        const [x, y] = worldToScreen(wp);
        ctx.lineTo(x, y);
    });
    state.perfect_line.forEach(wp => {
        const [x, y] = worldToScreen(wp);
        ctx.lineTo(x, y);
    });
    ctx.closePath();
    ctx.strokeStyle = '#9ca3af';
    ctx.lineWidth = 2;
    ctx.stroke();

    // Waypoints
    state.waypoints.forEach((wp, idx) => {
        const [sx, sy] = worldToScreen(wp);
        ctx.beginPath();
        ctx.arc(sx, sy, 8, 0, 2 * Math.PI);
        ctx.fillStyle = state.closestWaypoints.includes(idx) ? '#6366f1' : '#6b7280';
        ctx.fill();

        ctx.fillStyle = 'white';
        ctx.font = 'bold 10px Inter';
        ctx.textAlign = 'center';
        ctx.textBaseline = 'middle';
        ctx.fillText(idx, sx, sy);
    });
    // state.perfect_line.forEach((wp, idx) => {
    //     const [sx, sy] = worldToScreen(wp);
    //     ctx.beginPath();
    //     ctx.arc(sx, sy, 8, 0, 2 * Math.PI);
    //     ctx.fillStyle = state.closestWaypoints.includes(idx) ? '#6366f1' : '#6b7280';
    //     ctx.fill();

    //     ctx.fillStyle = 'white';
    //     ctx.font = 'bold 10px Inter';
    //     ctx.textAlign = 'center';
    //     ctx.textBaseline = 'middle';
    //     ctx.fillText(idx, sx, sy);
    // });

    // Car
    ctx.save();
    const [carX, carY] = worldToScreen([state.car.x, state.car.y]);
    ctx.translate(carX, carY);
    ctx.rotate(state.car.heading * Math.PI / 180);
    ctx.fillStyle = '#ef4444';
    ctx.fillRect(-15, -10, 30, 20);
    ctx.fillStyle = '#f87171';
    ctx.fillRect(-10, -8, 20, 16);
    ctx.beginPath();
    ctx.moveTo(15, 0);
    ctx.lineTo(35, 0);
    ctx.strokeStyle = '#ef4444';
    ctx.lineWidth = 3;
    ctx.stroke();
    ctx.restore();
}


function updateUI() {
    carXValue.textContent = state.car.x;
    carYValue.textContent = state.car.y;
    closestWaypoints.textContent = state.closestWaypoints
    headingValue.textContent = `${Math.round(state.car.heading)}°`;
    speedValue.textContent = state.car.speed.toFixed(1);
    fetchReward();
}

function render() {
    draw();
    updateUI();
}

function screenToCanvas(e) {
    const rect = canvas.getBoundingClientRect();
    return { x: e.clientX - rect.left, y: e.clientY - rect.top };
}

// --- Events ---
carXSlider.addEventListener('input', e => { state.car.x = +e.target.value; render(); });
carYSlider.addEventListener('input', e => { state.car.y = +e.target.value; render(); });
headingSlider.addEventListener('input', e => { state.car.heading = +e.target.value; render(); });
speedSlider.addEventListener('input', e => { state.car.speed = +e.target.value; render(); });

lookAtMouseCheckbox.addEventListener('change', e => { lookAtMouse = e.target.checked; });

canvas.addEventListener('mousedown', e => {
    const pos = screenToCanvas(e); // screen coords
    const [carX, carY] = worldToScreen([state.car.x, state.car.y]);

    const dx = pos.x - carX;
    const dy = pos.y - carY;

    if (Math.sqrt(dx*dx + dy*dy) < 20) {
        draggingCar = true;
    }
});

canvas.addEventListener('mousemove', e => {
    mousePos = screenToCanvas(e);
    if (draggingCar) {
        // convert back into world coords
        const [wx, wy] = screenToWorld(mousePos);
        state.car.x = wx;
        state.car.y = wy;
        render();
    }
});

canvas.addEventListener('mouseup', () => draggingCar = false);
canvas.addEventListener('mouseleave', () => draggingCar = false);

function animate() {
    if (lookAtMouse) {
        const dx = mousePos.x - state.car.x;
        const dy = mousePos.y - state.car.y;
        state.car.heading = Math.atan2(dy, dx) * (180 / Math.PI);
        render();
    }
    requestAnimationFrame(animate);
}

// Init
window.addEventListener('resize', render);
loadModels();
render();
animate();
</script>
</body>
</html>
